services:
  jclipper-test:
    container_name: jclipper-test
    environment:
      - MOVIES_DIR=/movies
      - OUTPUT_DIR=/output
      - VIDEO_EXTENSIONS=mp4,mkv,avi,mov,wmv,flv
      - SECRET_KEY=fECzEd7vBZkCxTAr1uSv45kDGchkKn #Required
      - PREVIEW_RESOLUTION=1280x720 #Optional
      - DEFAULT_LANGUAGE=en
    image: jermanoid/jclipper:v0.1.0
    labels:
      - traefik.enable=true
      - traefik.http.routers.jclipper-test.entrypoints=websecure
      - traefik.http.routers.jclipper-test.tls.certresolver=prod
      - traefik.http.routers.jclipper-test.middlewares=localonly@file
      - traefik.http.routers.jclipper-test.rule=Host(`jclipper-test.jermanoid.com`)
      - traefik.http.routers.jclipper-test.service=jclipper
      - traefik.http.services.jclipper.loadbalancer.server.port=5000
      - homepage.group=Downloaders
      - homepage.name=Jclipper-test
      - homepage.icon=/icons/jnd.png
      - homepage.href=https://jclipper-test.jermanoid.com
      - homepage.description=Create clips from movies in the movie library
    networks:
      - proxy
    ports:
      - "5001:5000"
    restart: unless-stopped
    volumes:
      - /mnt/mercury/video/movies/main:/movies:ro  #Movies directory
      - /mnt/mercury/video/movies/clips/output:/output #Output directory
      #- /mnt/mercury/video/movies/clips/temp:/tmp/jclipper #Temp directory
      - /mnt/mercury/software/jclipper/app:/app:ro # For Testing
networks:
  proxy:
    external: true
