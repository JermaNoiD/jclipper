{% extends 'base.html' %}
{% block title %}Jclipper - Subtitles{% endblock %}
{% block content %}
<nav class="bg-gray-100 py-4 dark:bg-gray-900 transition-colors">
    <div class="container mx-auto px-4">
        <div class="flex justify-center">
            <input type="text" id="searchInput" class="w-full max-w-2xl bg-white text-gray-900 text-center italic text-lg rounded-lg py-3 px-4 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:focus:ring-gray-500 placeholder-gray-500 dark:placeholder-gray-400 transition-colors" placeholder="Search subtitles..." onkeyup="handleSearchKey(event)">
        </div>
    </div>
</nav>
<div class="container mx-auto mt-8 px-4 flex-grow">
    <h1 class="text-xl font-bold text-gray-900 dark:text-gray-200 flex justify-center sticky top-0 bg-white dark:bg-gray-800 z-10 p-0 w-100% border-t border-l border-r rounded-t-lg border-gray-300 dark:border-gray-700 max-w-3xl mx-auto transition-colors">{{ pretty_movie_name }}</h1>
    <div class="bg-white rounded-b-lg border border-gray-300 p-4 max-w-3xl mx-auto min-h-[200px] max-h-[60vh] overflow-y-auto no-scrollbar dark:bg-gray-800 dark:border-gray-700 transition-colors">
        {% if subs %}
        <form id="subtitle-form" method="POST" action="{{ url_for('output') }}">
            <input type="hidden" id="startTime" name="start">
            <input type="hidden" id="endTime" name="end">
            <input type="hidden" name="video" value="{{ movie }}">
            <ul class="space-y-2">
                {% for sub in subs %}
                <li class="subtitle-item p-1 rounded-md hover:bg-gray-200 cursor-pointer transition-colors dark:hover:bg-gray-700 flex" onclick="toggleSelection(this)" data-start-time="{{ sub.start_str }}" data-end-time="{{ sub.end_str }}" data-original-content="{{ sub.content }}">
                    <div class="w-1/4 flex flex-col justify-between text-gray-500 dark:text-gray-400 text-xs">
                        <p>{{ sub.start_str }}</p>
                        <p>{{ sub.end_str }}</p>
                    </div>
                    <div class="subtitle-content flex-1 pl-4 text-gray-900 dark:text-gray-200">
                        {{ sub.content }}
                    </div>
                </li>
                {% if not loop.last %}
                <li class="separator-item p-1 rounded-md hover:bg-gray-200 cursor-pointer transition-colors dark:hover:bg-gray-700 flex items-center w-full" onclick="toggleSelection(this)" data-start-time="{{ sub.end_str }}" data-end-time="{{ subs[loop.index].start_str }}">
                    <div class="flex justify-center w-full">
                        <hr class="flex-1 border-t border-gray-300 dark:border-gray-600">
                    </div>
                    <div class="separator-content flex-1 pl-4 text-gray-900 dark:text-gray-200"></div>
                </li>
                {% endif %}
                {% endfor %}
            </ul>
        </form>
        {% else %}
        <div class="text-red-900 text-base opacity-100 bg-red-200 dark:bg-red-900 dark:text-red-300 px-2 py-1 rounded text-center transition-colors">No subtitle file available</div>
        {% endif %}
    </div>
    <div class="mt-4 flex justify-center space-x-4 max-w-3xl mx-auto">
        <a href="{{ back_url }}" class="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center" title="Back">
            <i class="fas fa-arrow-left"></i>
        </a>
        <button class="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center" onclick="clearSelections()" title="Clear Selections">
            <i class="fas fa-eraser"></i>
        </button>
        <button id="submitButton" class="bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 dark:bg-green-400 dark:hover:bg-green-300 transition-colors flex items-center" onclick="createClip()" title="Create Clip" disabled>
            <i class="fas fa-check-circle"></i>
        </button>
    </div>
</div>
{% endblock %}
{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/themeToggle.js') }}"></script>
<script src="{{ url_for('static', filename='js/subtitles.js') }}"></script>
{% endblock %}